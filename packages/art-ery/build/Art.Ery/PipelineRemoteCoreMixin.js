"use strict"
let Caf = require('caffeine-script-runtime');
Caf.defMod(module, () => {return Caf.importInvoke(["Request", "config", "compactFlatten", "inspectedObjectLiteral", "merge"], [global, require('./StandardImport'), {Request: require('./Request')}], (Request, config, compactFlatten, inspectedObjectLiteral, merge) => {return function(superClass) {let PipelineRemoteCoreMixin; return PipelineRemoteCoreMixin = Caf.defClass(class PipelineRemoteCoreMixin extends superClass {}, function(PipelineRemoteCoreMixin, classSuper, instanceSuper) {this.abstractClass(); this.remoteServer = function(_remoteServer) {this._remoteServer = _remoteServer;}; this.apiRoot = function(_apiRoot) {this._apiRoot = _apiRoot;}; this.getter({apiReport: function(options) {let server, publicOnly; if (Caf.exists(options)) {server = options.server; publicOnly = options.publicOnly;}; return Caf.object(this.requestTypes, (type) => {let method, url; ({method, url} = Request.getRestClientParamsForArtEryRequest({server: this.remoteServer || server, type, restPath: this.restPath})); return {[`${Caf.toString(method.toLocaleUpperCase())}`]: url};}, (type) => !publicOnly || this.getPublicRequestTypes()[type]);}, isRemoteClient: function() {return !!this.remoteServer;}, apiRoot: function() {return this.class._apiRoot || config._apiRoot;}, remoteServer: function() {return this.class._remoteServer || config.remoteServer;}, location: function() {return (this.remoteServer && config.location !== "server") ? "client" : config.location;}}); this.prototype.handleRequest = function(request) {return (this.location === "client" && this.remoteServer) ? request.sendRemoteRequest(this.remoteServer) : instanceSuper.handleRequest.apply(this, arguments);}; this.prototype.getRequestProcessingReport = function(location = this.location) {return Caf.object(this.requestTypes, (requestType) => compactFlatten([Caf.array(this.getBeforeFilters({requestType, location}), (filter) => inspectedObjectLiteral(filter.getName())), inspectedObjectLiteral((location === "client") ? "[remote request]" : "[local handler]"), Caf.array(this.getAfterFilters({requestType, location}), (filter) => inspectedObjectLiteral(filter.getName()))]));}; this.prototype.getPipelineReport = function() {return merge(instanceSuper.getPipelineReport.apply(this, arguments), {clientSideRequestProcessing: this.getRequestProcessingReport("client"), serverSideRequestProcessing: this.getRequestProcessingReport("server")});};});};});});
//# sourceMappingURL=PipelineRemoteCoreMixin.js.map
