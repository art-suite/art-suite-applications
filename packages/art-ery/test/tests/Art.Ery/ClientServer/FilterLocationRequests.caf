import &StandardImport

suite: ->
  savedRemoteServer = null
  global.setup ->
    savedRemoteServer = pipelines.filterLocation.remoteServer

  global.teardown ->
    pipelines.filterLocation.class.remoteServer savedRemoteServer

  test "client location", ->
    assert.eq pipelines.filterLocation.location, :client
    pipelines.filterLocation.filterTest returnResponseObject: true data: trace: :ZOWIE
    .then (response) ->
      assert.eq response.data.customLog, []
        :before-bothFilter@client
        :before-clientFilter@client
        :before-serverFilter@server
        :before-bothFilter@server
        :handler@server
        :after-bothFilter@server
        :after-serverFilter@server
        :after-clientFilter@client
        :after-bothFilter@client

      assert.selectedEq
        name: "POST http://localhost:8085/api/filterLocation-filterTest"
        context: :remoteRequest
        response.handledBy
