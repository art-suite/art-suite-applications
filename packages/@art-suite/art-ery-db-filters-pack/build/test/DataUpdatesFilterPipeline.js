"use strict"
let Caf = require('caffeine-script-runtime');
Caf.defMod(module, () => {return Caf.importInvoke(["PipelineRegistry", "DataUpdatesFilter", "isString"], [global, require('./StandardImport')], (PipelineRegistry, DataUpdatesFilter, isString) => {return function() {let DataUpdatesFilterPipeline; return DataUpdatesFilterPipeline = Caf.defClass(class DataUpdatesFilterPipeline extends require('./SimpleStore') {}, function(DataUpdatesFilterPipeline, classSuper, instanceSuper) {this.registry(new PipelineRegistry({location: "client"})); this.publicRequestTypes("subrequestTest", "update", "delete", "usersByEmail"); this.filter(DataUpdatesFilter); this.filter({before: {create: function(request) {return request.withMergedData({createdAt: 123, updatedAt: 123});}, update: function(request) {return request.withMergedData({updatedAt: 321});}}}); this.query({usersByEmail: {query: function({key}) {return Caf.array(this.db, null, (v, k) => v.email === key);}, dataToKeyString: function({email}) {return email;}}}); this.handlers({subrequestTest: function(request) {let key, data, type; ({key, data, type} = request.data); return request.require(isString(type), "subrequestTest needs a request-type").then(() => request.subrequest(request.pipelineName, type, {key, data}));}});});};});});
//# sourceMappingURL=DataUpdatesFilterPipeline.js.map
