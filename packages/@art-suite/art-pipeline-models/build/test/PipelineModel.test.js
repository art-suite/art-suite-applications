"use strict"
let Caf = require('caffeine-script-runtime');
Caf.defMod(module, () => {return Caf.importInvoke(["newRegistries", "ArtModelSubscriptionsMixin", "BaseObject", "SimplePipeline", "test", "assert", "ArtModel", "Promise", "success", "missing"], [global, require('./StandardImport'), {SimplePipeline: require('./SimplePipeline')}], (newRegistries, ArtModelSubscriptionsMixin, BaseObject, SimplePipeline, test, assert, ArtModel, Promise, success, missing) => {let orderLog, User, user, MySubscriber, registry, pipelineRegistry, modelRegistry, defineModelsForAllPipelines; orderLog = []; User = user = MySubscriber = registry = null; ({pipelineRegistry, modelRegistry, defineModelsForAllPipelines} = newRegistries()); MySubscriber = Caf.defClass(class MySubscriber extends ArtModelSubscriptionsMixin(BaseObject) {}, function(MySubscriber, classSuper, instanceSuper) {this.modelRegistry(modelRegistry);}); User = Caf.defClass(class User extends SimplePipeline {}, function(User, classSuper, instanceSuper) {this.registry(pipelineRegistry);}); ({user} = defineModelsForAllPipelines()); test("model.propsToKey", function() {assert.eq("user1", user.propsToKey({user: {id: "user1"}})); assert.eq("user2", user.propsToKey({userId: "user2"})); assert.eq("user3", user.propsToKey({user: {id: "user3"}, userId: "user4"}), "whole object has precidence"); return assert.eq(undefined, user.propsToKey({}));}); test("user instanceof ArtModel", function() {return assert.instanceOf(user, ArtModel);}); test("myModel.create", function() {return user.create({data: {username: "Shane", message: "Hi"}});}); test("create with missing required field", function() {return user.create({data: {username: "Shane", message: ""}});}); test("subscribe when state is success", function() {return user.pipeline.reset({data: {123: {name: "alice"}}}).then(() => {let mySubscriber; mySubscriber = new MySubscriber; return new Promise((resolve) => mySubscriber.subscribe({modelName: "user", key: "123", callback: (artModelRecord) => (artModelRecord.status === success) ? resolve() : undefined}));});}); return test("subscribe when state is missing", function() {return user.pipeline.reset({data: {123: {name: "alice"}}}).then(() => {let mySubscriber; mySubscriber = new MySubscriber; return new Promise((resolve) => mySubscriber.subscribe({modelName: "user", key: "456", callback: (artModelRecord) => (artModelRecord.status === missing) ? resolve() : undefined}));});});});});
//# sourceMappingURL=PipelineModel.test.js.map
