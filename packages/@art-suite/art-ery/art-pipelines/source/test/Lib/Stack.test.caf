import &StandardImport, &build.Lib.Stack

getEnv().ART_PIPELINES_REPATH_STACK_TRACE = true

test "cleanStackTrace" ->
  assert.eq
    cleanStackTrace
      """
        first-line
          at #{process.cwd()}/source/index.js:1:5
          at Object.array (#{process.cwd()}/source/index.js:1:5)
    """
      \_\_at source/index.js:1:5
        at Object.array (source/index.js:1:5)
      NOTE: cleanStackTrace applied. (set ART_PIPELINES_CLEAN_STACK_TRACE=false to disable)
      NOTE: repathStackTraceLine(s) applied. (set ART_PIPELINES_REPATH_STACK_TRACE=false to disable)
