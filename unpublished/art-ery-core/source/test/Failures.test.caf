import &StandardImport

ArtConfig.configure()

test :clientFailure ->
  class MyPipeline extends Pipeline
    @handlers create: (request) -> foo: 1, bar: 2
    @filter name: :myFilter1 after: create: (response) -> response
    @filter name: :myFilter2 after: create: (response) -> response.clientFailure "you lose!"
    @filter name: :myFilter3 after: create: (response) -> response

  p = new MyPipeline
  assert.isClientFailure p.create()
  .then ({info:{response}}) ->
    assert.eq response.failedRequest.filter.after.create.name, :myFilter2